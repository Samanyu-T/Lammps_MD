# Boilerplate code generated by OVITO Pro 3.9.2
from ovito.io import *
from ovito.modifiers import *
from ovito.data import *
from ovito.pipeline import *
import numpy as np

# Data import:
pipeline = import_file('/Users/cd8607/Documents/Lammps_MD/He_Diffusion/Atom_Files/test.*.atom')

# Expression selection:
pipeline.modifiers.append(ExpressionSelectionModifier(expression = 'ParticleType==1'))

# Delete selected:
pipeline.modifiers.append(DeleteSelectedModifier())

# Unwrap trajectories:
pipeline.modifiers.append(UnwrapTrajectoriesModifier())

pos = []

for i,frame in enumerate(range(pipeline.source.num_frames)):
    data = pipeline.compute(frame)

    _pos = np.array(data.particles.positions)
    
    pos.append(_pos[0])

pos = np.array(pos)

np.savetxt('He_Diffusion/trajectory.txt', pos)
